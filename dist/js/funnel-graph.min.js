!function(a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a():"function"==typeof define&&define.amd?define([],a):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).FunnelGraph=a()}(function(){return(function(){function a(e,f,c){function d(b,k){if(!f[b]){if(!e[b]){var i="function"==typeof require&&require;if(!k&&i)return i(b,!0);if(g)return g(b,!0);var j=new Error("Cannot find module '"+b+"'");throw j.code="MODULE_NOT_FOUND",j}var h=f[b]={exports:{}};e[b][0].call(h.exports,function(a){return d(e[b][1][a]||a)},h,h.exports,a,e,f,c)}return f[b].exports}for(var g="function"==typeof require&&require,b=0;b<c.length;b++)d(c[b]);return d}return a})()({1:[function(a,b,c){"use strict";b.exports=a("./src/js/main").default},{"./src/js/main":3}],2:[function(d,e,a){"use strict";function f(a){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}Object.defineProperty(a,"__esModule",{value:!0}),a.defaultColors=a.removeAttrs=a.setAttrs=a.createSVGElement=a.areEqual=a.getDefaultColors=a.generateLegendBackground=void 0;var b=function(b,a){"object"===f(a)&&Object.keys(a).forEach(function(c){b.setAttribute(c,a[c])})};a.setAttrs=b,a.removeAttrs=function(d){for(var b=arguments.length,c=new Array(b>1?b-1:0),a=1;a<b;a++)c[a-1]=arguments[a];c.forEach(function(a){d.removeAttribute(a)})},a.createSVGElement=function(e,c,d){var a=document.createElementNS("http://www.w3.org/2000/svg",e);return"object"===f(d)&&b(a,d),void 0!==c&&c.appendChild(a),a},a.generateLegendBackground=function(a){var b=arguments.length>1&& void 0!==arguments[1]?arguments[1]:"horizontal";return"string"==typeof a?"background-color: ".concat(a):1===a.length?"background-color: ".concat(a[0]):"background-image: linear-gradient(".concat("horizontal"===b?"to right, ":"").concat(a.join(", "),")")};var c=["#FF4589","#FF5050","#05DF9D","#4FF2FD","#2D9CDB","#A0BBFF","#FFD76F","#F2C94C","#FF9A9A","#FFB178"];a.defaultColors=c,a.getDefaultColors=function(f){for(var a=[].concat(c),b=[],d=0;d<f;d++){var e=Math.abs(Math.round(Math.random()*(a.length-1)));b.push(a[e]),a.splice(e,1)}return b},a.areEqual=function(b,c){var e=Object.prototype.toString.call(b);if(e!==Object.prototype.toString.call(c)||"[object Array]"!==e||b.length!==c.length)return!1;for(var a=0;a<b.length;a++){var f=Object.prototype.toString.call(b[a]);if(f!==Object.prototype.toString.call(c[a]))return!1;if("[object Array]"===f){if(b[a].length!==c[a].length)return!1;for(var d=0;d<b[a].length;d++)if(b[a][d]!==c[a][d])return!1}else if(b[a]!==c[a])return!1}return!0}},{}],3:[function(a,e,c){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),c.default=void 0;var b,f=a("./number"),g=a("./path"),h=a("./graph"),i=(b=a("./random"))&&b.__esModule?b:{default:b};function j(a){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function k(a){return n(a)||m(a)||l()}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function m(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function n(a){if(Array.isArray(a)){for(var b=0,c=new Array(a.length);b<a.length;b++)c[b]=a[b];return c}}function o(d,c){for(var b=0;b<c.length;b++){var a=c[b];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(d,a.key,a)}}var d=function(){var a,b,c;function d(a){!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,d),this.containerSelector=a.container,this.gradientDirection=a.gradientDirection&&"vertical"===a.gradientDirection?"vertical":"horizontal",this.direction=a.direction&&"vertical"===a.direction?"vertical":"horizontal",this.labels=d.getLabels(a),this.subLabels=d.getSubLabels(a),this.values=d.getValues(a),this.colors=a.data.colors||(0,h.getDefaultColors)(this.is2d()?this.getSubDataSize():2),this.displayPercent=a.displayPercent||!1,this.total=a.total||0,this.percentages=this.createPercentages(this.total),this.data=a.data,this.height=a.height,this.width=a.width,this.subLabelValue=a.subLabelValue||"percent"}return a=d,b=[{key:"getMainAxisPoints",value:function(){for(var b=this.getDataSize(),c=[],d=this.isVertical()?this.getHeight():this.getWidth(),a=0;a<=b;a++)c.push((0,f.roundPoint)(d*a/b));return c}},{key:"getCrossAxisPoints",value:function(){var a=[],g=this.getFullDimension(),m=g/2;if(this.is2d()){var c=this.getValues2d(),n=Math.max.apply(Math,k(c));c.push(k(c).pop()),a.push(c.map(function(a){return(0,f.roundPoint)((n-a)/n*m)}));for(var i=this.getPercentages2d(),h=a[0],d=1;d<this.getSubDataSize();d++){for(var j=a[d-1],e=[],b=0;b<this.getDataSize();b++)e.push((0,f.roundPoint)(j[b]+(g-2*h[b])*(i[b][d-1]/100)));e.push([].concat(e).pop()),a.push(e)}a.push(h.map(function(a){return g-a}))}else{var o=Math.max.apply(Math,k(this.values)),l=k(this.values).concat(k(this.values).pop());a.push(l.map(function(a){return(0,f.roundPoint)((o-a)/o*m)})),a.push(a[0].map(function(a){return g-a}))}return a}},{key:"getGraphType",value:function(){return this.values&&this.values[0]instanceof Array?"2d":"normal"}},{key:"is2d",value:function(){return"2d"===this.getGraphType()}},{key:"isVertical",value:function(){return"vertical"===this.direction}},{key:"getDataSize",value:function(){return this.values.length}},{key:"getSubDataSize",value:function(){return this.values[0].length}},{key:"getFullDimension",value:function(){return this.isVertical()?this.getWidth():this.getHeight()}},{key:"addLabels",value:function(){var b=this,a=document.createElement("div");a.setAttribute("class","svg-funnel-js__labels"),this.percentages.forEach(function(k,d){var c=document.createElement("div");c.setAttribute("class","svg-funnel-js__label label-".concat(d+1));var e=document.createElement("div");e.setAttribute("class","label__title"),e.textContent=b.labels[d]||"";var g=document.createElement("div");g.setAttribute("class","label__value");var l=b.is2d()?b.getValues2d()[d]:b.values[d];g.textContent=(0,f.formatNumber)(l);var h=document.createElement("div");if(h.setAttribute("class","label__percentage"),h.textContent="".concat(k.toString(),"%"),c.appendChild(g),c.appendChild(e),b.displayPercent&&c.appendChild(h),b.is2d()){var i=document.createElement("div");i.setAttribute("class","label__segment-percentages");var j='<ul class="segment-percentage__list">',m=b.getPercentages2d();b.subLabels.forEach(function(e,a){var c="percent"===b.subLabelValue?"".concat(m[d][a],"%"):(0,f.formatNumber)(b.values[d][a]);j+="<li>".concat(b.subLabels[a],':\n    <span class="percentage__list-label">').concat(c,"</span>\n </li>")}),j+="</ul>",i.innerHTML=j,c.appendChild(i)}a.appendChild(c)}),this.container.appendChild(a)}},{key:"addSubLabels",value:function(){var c=this;if(this.subLabels){var a=document.createElement("div");a.setAttribute("class","svg-funnel-js__subLabels");var b="";this.subLabels.forEach(function(d,a){b+='<div class="svg-funnel-js__subLabel svg-funnel-js__subLabel-'.concat(a+1,'">\n    <div class="svg-funnel-js__subLabel--color"\n        style="').concat((0,h.generateLegendBackground)(c.colors[a],c.gradientDirection),'"></div>\n    <div class="svg-funnel-js__subLabel--title">').concat(d,"</div>\n</div>")}),a.innerHTML=b,this.container.appendChild(a)}}},{key:"createContainer",value:function(){if(!this.containerSelector)throw new Error("Container is missing");if("string"==typeof this.containerSelector){if(this.container=document.querySelector(this.containerSelector),!this.container)throw new Error("Container cannot be found (selector: ".concat(this.containerSelector,")."))}else if(this.container instanceof HTMLElement)this.container=this.containerSelector;else throw new Error("Container must either be a selector string or an HTMLElement.");this.container.classList.add("svg-funnel-js"),this.graphContainer=document.createElement("div"),this.graphContainer.classList.add("svg-funnel-js__container"),this.container.appendChild(this.graphContainer),"vertical"===this.direction&&this.container.classList.add("svg-funnel-js--vertical")}},{key:"setValues",value:function(a){return this.values=a,this}},{key:"setDirection",value:function(a){return this.direction=a,this}},{key:"setHeight",value:function(a){return this.height=a,this}},{key:"setWidth",value:function(a){return this.width=a,this}},{key:"getValues2d",value:function(){var a=[];return this.values.forEach(function(b){a.push(b.reduce(function(a,b){return a+b},0))}),a}},{key:"getPercentages2d",value:function(){var a=[];return this.values.forEach(function(b){var c=b.reduce(function(a,b){return a+b},0);a.push(b.map(function(a){return 0===c?0:(0,f.roundPoint)(100*a/c)}))}),a}},{key:"createPercentages",value:function(b){var a=[];a=this.is2d()?this.getValues2d():k(this.values);var c=Math.max.apply(Math,k(a));return a.map(function(a){return 0===a?0:(0,f.roundPoint)(100*a/(b||c))})}},{key:"applyGradient",value:function(b,g,d,j){var k=null===b.querySelector("defs")?(0,h.createSVGElement)("defs",b):b.querySelector("defs"),c=(0,i.default)("funnelGradient-".concat(j,"-")),e=(0,h.createSVGElement)("linearGradient",k,{id:c});"vertical"===this.gradientDirection&&(0,h.setAttrs)(e,{x1:"0",x2:"0",y1:"0",y2:"1"});for(var f=d.length,a=0;a<f;a++)(0,h.createSVGElement)("stop",e,{"stop-color":d[a],offset:"".concat(Math.round(100*a/(f-1)),"%")});(0,h.setAttrs)(g,{fill:'url("#'.concat(c,'")'),stroke:'url("#'.concat(c,'")')})}},{key:"makeSVG",value:function(){for(var b=(0,h.createSVGElement)("svg",this.graphContainer,{width:this.getWidth(),height:this.getHeight()}),f=this.getCrossAxisPoints().length-1,c=0;c<f;c++){var d=(0,h.createSVGElement)("path",b),a=this.is2d()?this.colors[c]:this.colors,e="string"==typeof a||1===a.length?"solid":"gradient";"solid"===e?(0,h.setAttrs)(d,{fill:a,stroke:a}):"gradient"===e&&this.applyGradient(b,d,a,c+1),b.appendChild(d)}this.graphContainer.appendChild(b)}},{key:"getSVG",value:function(){var a=this.container.querySelector("svg");if(!a)throw new Error("No SVG found inside of the container");return a}},{key:"getWidth",value:function(){return this.width||this.graphContainer.clientWidth}},{key:"getHeight",value:function(){return this.height||this.graphContainer.clientHeight}},{key:"getPathDefinitions",value:function(){for(var c=this.getCrossAxisPoints().length-1,b=[],a=0;a<c;a++)if(this.isVertical()){var d=this.getCrossAxisPoints()[a],e=this.getCrossAxisPoints()[a+1],f=this.getMainAxisPoints(),h=(0,g.createVerticalPath)(a,d,e,f);b.push(h)}else{var i=this.getMainAxisPoints(),j=this.getCrossAxisPoints()[a],k=this.getCrossAxisPoints()[a+1],l=(0,g.createPath)(a,i,j,k);b.push(l)}return b}},{key:"getPathMedian",value:function(a){if(this.isVertical()){var b=this.getCrossAxisPoints()[a],k=this.getCrossAxisPoints()[a+1],c=this.getMainAxisPoints(),d=[],e=[];return b.forEach(function(b,c){var a=(b+k[c])/2;d.push(a-1),e.push(a+1)}),(0,g.createVerticalPath)(a,d,e,c)}var f=this.getMainAxisPoints(),h=this.getCrossAxisPoints()[a],l=this.getCrossAxisPoints()[a+1],i=[],j=[];return h.forEach(function(b,c){var a=(b+l[c])/2;i.push(a-1),j.push(a+1)}),(0,g.createPath)(a,f,i,j)}},{key:"drawPaths",value:function(){var a=this.getSVG().querySelectorAll("path");this.getPathDefinitions().forEach(function(b,c){a[c].setAttribute("d",b)})}},{key:"draw",value:function(){this.createContainer(),this.makeSVG(),this.addLabels(),this.is2d()&&this.addSubLabels(),this.drawPaths()}},{key:"makeVertical",value:function(){if("vertical"===this.direction)return!0;this.direction="vertical",this.container.classList.add("svg-funnel-js--vertical");var a=this.getSVG(),b=this.getHeight(),c=this.getWidth();return(0,h.setAttrs)(a,{height:b,width:c}),this.drawPaths(),!0}},{key:"makeHorizontal",value:function(){if("horizontal"===this.direction)return!0;this.direction="horizontal",this.container.classList.remove("svg-funnel-js--vertical");var a=this.getSVG(),b=this.getHeight(),c=this.getWidth();return(0,h.setAttrs)(a,{height:b,width:c}),this.drawPaths(),!0}},{key:"toggleDirection",value:function(){"horizontal"===this.direction?this.makeVertical():this.makeHorizontal()}},{key:"gradientMakeVertical",value:function(){if("vertical"===this.gradientDirection)return!0;this.gradientDirection="vertical";for(var b=this.graphContainer.querySelectorAll("linearGradient"),a=0;a<b.length;a++)(0,h.setAttrs)(b[a],{x1:"0",x2:"0",y1:"0",y2:"1"});return!0}},{key:"gradientMakeHorizontal",value:function(){if("horizontal"===this.gradientDirection)return!0;this.gradientDirection="horizontal";for(var b=this.graphContainer.querySelectorAll("linearGradient"),a=0;a<b.length;a++)(0,h.removeAttrs)(b[a],"x1","x2","y1","y2");return!0}},{key:"gradientToggleDirection",value:function(){"horizontal"===this.gradientDirection?this.gradientMakeVertical():this.gradientMakeHorizontal()}},{key:"updateWidth",value:function(a){this.width=a;var b=this.getSVG(),c=this.getWidth();return(0,h.setAttrs)(b,{width:c}),this.drawPaths(),!0}},{key:"updateHeight",value:function(a){this.height=a;var b=this.getSVG(),c=this.getHeight();return(0,h.setAttrs)(b,{height:c}),this.drawPaths(),!0}},{key:"updateData",value:function(a){var b=this.container.querySelector(".svg-funnel-js__labels"),c=this.container.querySelector(".svg-funnel-js__subLabels");b&&b.remove(),c&&c.remove(),this.labels=[],this.colors=(0,h.getDefaultColors)(this.is2d()?this.getSubDataSize():2),this.values=[],this.percentages=[],void 0!==a.labels&&(this.labels=d.getLabels({data:a})),void 0!==a.colors&&(this.colors=a.colors||(0,h.getDefaultColors)(this.is2d()?this.getSubDataSize():2)),void 0!==a.values&&(Object.prototype.toString.call(a.values[0])!==Object.prototype.toString.call(this.values[0])?(this.container.querySelector("svg").remove(),this.values=d.getValues({data:a}),this.makeSVG()):this.values=d.getValues({data:a}),this.drawPaths()),this.percentages=this.createPercentages(this.total),this.addLabels(),void 0!==a.subLabels&&(this.subLabels=d.getSubLabels({data:a}),this.addSubLabels())}},{key:"update",value:function(a){var b=this;void 0!==a.displayPercent&&this.displayPercent!==a.displayPercent&&(!0===this.displayPercent?this.container.querySelectorAll(".label__percentage").forEach(function(a){a.remove()}):this.container.querySelectorAll(".svg-funnel-js__label").forEach(function(d,e){var c=b.percentages[e],a=document.createElement("div");a.setAttribute("class","label__percentage"),100!==c&&(a.textContent="".concat(c.toString(),"%"),d.appendChild(a))})),void 0!==a.height&&this.updateHeight(a.height),void 0!==a.width&&this.updateWidth(a.width),void 0!==a.gradientDirection&&("vertical"===a.gradientDirection?this.gradientMakeVertical():"horizontal"===a.gradientDirection&&this.gradientMakeHorizontal()),void 0!==a.direction&&("vertical"===a.direction?this.makeVertical():"horizontal"===a.direction&&this.makeHorizontal()),void 0!==a.data&&this.updateData(a.data)}}],c=[{key:"getSubLabels",value:function(a){if(!a.data)throw new Error("Data is missing");var b=a.data;return void 0===b.subLabels?[]:b.subLabels}},{key:"getLabels",value:function(a){if(!a.data)throw new Error("Data is missing");var b=a.data;return void 0===b.labels?[]:b.labels}},{key:"getValues",value:function(a){if(!a.data)return[];var b=a.data;return"object"===j(b)?b.values:[]}}],b&&o(a.prototype,b),c&&o(a,c),d}();c.default=d},{"./graph":2,"./number":4,"./path":5,"./random":6}],4:[function(b,c,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.formatNumber=a.roundPoint=void 0,a.roundPoint=function(a){return Math.round(10*a)/10},a.formatNumber=function(a){return Number(a).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}},{}],5:[function(b,e,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.createVerticalPath=a.createPath=a.createVerticalCurves=a.createCurves=void 0;var f=b("./number");function g(a){return j(a)||i(a)||h()}function h(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function i(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function j(a){if(Array.isArray(a)){for(var b=0,c=new Array(a.length);b<a.length;b++)c[b]=a[b];return c}}var c=function(b,d,a,c){return" C".concat((0,f.roundPoint)((a+b)/2),",").concat(d," ")+"".concat((0,f.roundPoint)((a+b)/2),",").concat(c," ").concat(a,",").concat(c)};a.createCurves=c;var d=function(d,b,c,a){return" C".concat(d,",").concat((0,f.roundPoint)((a+b)/2)," ")+"".concat(c,",").concat((0,f.roundPoint)((a+b)/2)," ").concat(c,",").concat(a)};a.createVerticalCurves=d,a.createPath=function(i,a,f,h){for(var e="M".concat(a[0],",").concat(f[0]),b=0;b<a.length-1;b++)e+=c(a[b],f[b],a[b+1],f[b+1]);e+=" L".concat(g(a).pop(),",").concat(g(h).pop());for(var d=a.length-1;d>0;d--)e+=c(a[d],h[d],a[d-1],h[d-1]);return e+" Z"},a.createVerticalPath=function(i,e,h,a){for(var f="M".concat(e[0],",").concat(a[0]),b=0;b<e.length-1;b++)f+=d(e[b],a[b],e[b+1],a[b+1]);f+=" L".concat(g(h).pop(),",").concat(g(a).pop());for(var c=e.length-1;c>0;c--)f+=d(h[c],a[c],h[c-1],a[c-1]);return f+" Z"}},{"./number":4}],6:[function(b,c,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,a.default=function(a){return Math.random().toString(36).replace("0.",a||"")}},{}]},{},[1])(1)})